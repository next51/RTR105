% I*R = U
% phi1*(1/R12 + 1/R34) - phi2*1/R34 = - J3+phi4*1/R12
% phi2*(1/R2 + 1/R7 + 1/R37) - phi3*1/R2 - phi1*1/R34 = E2/R2
% phi3*(1/R8 + 1/R6 + 1/R2) - phi2*1/R2 = phi*1/R8 - E2/R2

R1 = 1; R2 = 2; R3 = 1; R4 = 4; R5 = 5; R6 = 6; R7 = 7; R8 = 8;
E1 = 10;

t = 0:0.01:5;

E2 = sin(5*t);
J3 = lab4_m(t);

G = [1/(R1+R2)+1/(R3+R4),-1/(R3+R4),0;
    -1/(R3+R4),1/R2+1/R7+1/(R3+R4),-1/R2;
    0,-1/R2,1/R8+1/R6+1/R2];


i = [-J3-E1/(R1+R2);E2/R2;-E1/R8-E2/R2];
u = G\i;

I3 = (u(1,:)-u(2,:))/(R3+R4);
P3 = R3*I3.^2;

I2 = (u(3,:)-u(2,:)+E2)/R2;
I7 = (0 - u(2,:))/R7;


plot(t,J3,'k', t,I3,'r',t,P3,'b')
figure 
plot(t, I2+I3+I7)

grid on